<!DOCTYPE html>
<html lang="ur">
<head>
<meta charset="UTF-8">
<title>Anwar-ul-Uloom Islamic University - Ù†ØªÛŒØ¬Û Ø³Ø³Ù¹Ù…</title>
<style>
body{font-family:Arial;background:#eef2ee;margin:0}
.container{max-width:1100px;margin:auto;padding:20px}
header{text-align:center;color:#2f5d50;margin-bottom:20px}
.card{background:#fff;padding:20px;margin-bottom:20px;border-radius:10px;box-shadow:0 6px 15px rgba(0,0,0,.1)}
h2{color:#2f5d50;margin-top:0}
input,select,button{width:100%;padding:10px;margin-top:8px;border-radius:5px;border:1px solid #ccc}
button{background:#2f5d50;color:#fff;border:none;cursor:pointer;transition:0.3s}
button:hover{background:#3e7d65}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
.pass{color:green;font-weight:bold}
.fail{color:red;font-weight:bold}

/* A4 print styling */
@media print {
 body{background:#fff;margin:0;padding:0;font-size:14px}
 .container, .card{box-shadow:none;margin:0;padding:0;width:100%}
 button,input,select{display:none}
 table{page-break-inside:auto}
 tr{page-break-inside:avoid; page-break-after:auto}
}
</style>
</head>
<body>
<div class="container">

<header>
<h1>Anwar-ul-Uloom Islamic University</h1>
<hr>
</header>

<!-- Admin Login -->
<div class="card">
<h2>ğŸ” Ø§ÛŒÚˆÙ…Ù† Ù„Ø§Ú¯ Ø§ÙÙ†</h2>
<input type="password" id="adminPass" placeholder="Ø§ÛŒÚˆÙ…Ù† Ù¾Ø§Ø³ÙˆØ±Úˆ">
<button onclick="login()">Ù„Ø§Ú¯ Ø§ÙÙ†</button>
<p id="loginMsg"></p>
</div>

<!-- Admin Panel -->
<div class="card" id="adminPanel" style="display:none">
<h2>â• Ú©Ù„Ø§Ø³ Ú©Û’ Ù„ÛŒÛ’ Ú©ØªØ§Ø¨ÛŒÚº Ø§ÙˆØ± Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†ØªÛŒØ¬Û</h2>

<div class="grid">
<select id="className" onchange="loadClassBooks()">
<option>Ù…ØªÙˆØ³Ø·Û</option>
<option>Ø¹Ø§Ù…Û Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ø§Ù…Û Ø¯ÙˆÙ…</option>
<option>Ø®Ø§ØµÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø®Ø§ØµÛ Ø¯ÙˆÙ…</option>
<option>Ø¹Ø§Ù„ÛŒÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ø§Ù„ÛŒÛ Ø¯ÙˆÙ…</option>
<option>Ø¹Ù„Ù…ÛŒÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ù„Ù…ÛŒÛ Ø¯ÙˆÙ…</option>
<option>ØªØ®ØµÙ‘Øµ ÙÙ‚Û Ø³Ø§Ù„ Ø§ÙˆÙ‘Ù„</option>
<option>ØªØ®ØµÙ‘Øµ ÙÙ‚Û Ø³Ø§Ù„ Ø¯ÙˆÙ…</option>
</select>

<input id="roll" placeholder="Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±">
<input id="studentName" placeholder="Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù…">
<input id="fatherName" placeholder="ÙˆØ§Ù„Ø¯ Ú©Ø§ Ù†Ø§Ù…">
</div>

<h3>ğŸ“š Ú©ØªØ§Ø¨ÛŒÚº Ø§ÙˆØ± Ù†Ù…Ø¨Ø± ÚˆØ§Ù„ÛŒÚº</h3>
<div id="booksGrid" class="grid"></div>
<button onclick="addBookField()">â• Ù†Ø¦ÛŒ Ú©ØªØ§Ø¨ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</button>

<h3>ğŸ“ Ø§Ù…ØªØ­Ø§Ù† Ú©ÛŒ Ù‚Ø³Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</h3>
<select id="examType">
<option>Ø³ÛŒÙ…Ø§Ø¦ÛŒ Ø§Ù…ØªØ­Ø§Ù†</option>
<option>Ø´Ø´Ù…Ø§ÛÛŒ Ø§Ù…ØªØ­Ø§Ù†</option>
<option>Ø³Ø§Ù„Ø§Ù†Û Ø§Ù…ØªØ­Ø§Ù†</option>
</select>

<button onclick="addStudent()">Ù†ØªÛŒØ¬Û Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
<button onclick="deleteStudent()">âŒ Ù†ØªÛŒØ¬Û Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
<p id="msg"></p>

<hr>
<h3>âš™ï¸ Ù¾Ø§Ø³ÙˆØ±Úˆ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±ÛŒÚº</h3>
<input type="password" id="newPass" placeholder="Ù†ÛŒØ§ Ù¾Ø§Ø³ÙˆØ±Úˆ">
<button onclick="changePassword()">Ù¾Ø§Ø³ÙˆØ±Úˆ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±ÛŒÚº</button>
<p id="passMsg"></p>

<hr>
<button onclick="downloadBackup()">ğŸ“¥ Ø¨ÛŒÚ© Ø§ÙÙ¾ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ</button>
<input type="file" onchange="uploadBackup(this)">
</div>

<!-- Student/Talibat View -->
<div class="card">
<h2>ğŸ“ Ø§Ù¾Ù†Ø§ Ù†ØªÛŒØ¬Û Ø¯ÛŒÚ©Ú¾ÛŒÚº</h2>
<div class="grid">
<input id="stuRoll" placeholder="Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±">
<select id="stuYear">
<option>2024</option>
<option>2025</option>
<option>2026</option>
</select>
<select id="stuGender">
<option>Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù…</option>
<option>Ø·Ø§Ù„Ø¨Û</option>
</select>
<select id="stuClass">
<option>Ù…ØªÙˆØ³Ø·Û</option>
<option>Ø¹Ø§Ù…Û Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ø§Ù…Û Ø¯ÙˆÙ…</option>
<option>Ø®Ø§ØµÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø®Ø§ØµÛ Ø¯ÙˆÙ…</option>
<option>Ø¹Ø§Ù„ÛŒÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ø§Ù„ÛŒÛ Ø¯ÙˆÙ…</option>
<option>Ø¹Ù„Ù…ÛŒÛ Ø§ÙˆÙ‘Ù„</option>
<option>Ø¹Ù„Ù…ÛŒÛ Ø¯ÙˆÙ…</option>
<option>ØªØ®ØµÙ‘Øµ ÙÙ‚Û Ø³Ø§Ù„ Ø§ÙˆÙ‘Ù„</option>
<option>ØªØ®ØµÙ‘Øµ ÙÙ‚Û Ø³Ø§Ù„ Ø¯ÙˆÙ…</option>
</select>
</div>
<button onclick="checkStudentResult()">Ù†ØªÛŒØ¬Û Ø¯ÛŒÚ©Ú¾ÛŒÚº</button>
<button onclick="backSearch()">ğŸ”™ ÙˆØ§Ù¾Ø³</button>
<div id="stuResult"></div>
<button onclick="printStudentResult()">ğŸ–¨ Ù¾Ø±Ù†Ù¹ / PDF</button>
</div>

</div>

<script>
if(!localStorage.getItem("adminPassword")) localStorage.setItem("adminPassword","Qamar1654");
let students=JSON.parse(localStorage.getItem("students"))||{};
let classBooks=JSON.parse(localStorage.getItem("classBooks"))||{};

function login(){
 const savedPass = localStorage.getItem("adminPassword");
 if(adminPass.value===savedPass){
  adminPanel.style.display="block";
  loginMsg.innerHTML="âœ… Ú©Ø§Ù…ÛŒØ§Ø¨";
 } else loginMsg.innerHTML="âŒ ØºÙ„Ø· Ù¾Ø§Ø³ÙˆØ±Úˆ";
}

function changePassword(){
 const newP = document.getElementById("newPass").value;
 if(!newP){ passMsg.innerHTML="âŒ Ù†ÛŒØ§ Ù¾Ø§Ø³ÙˆØ±Úˆ ÚˆØ§Ù„ÛŒÚº"; return; }
 localStorage.setItem("adminPassword",newP);
 passMsg.innerHTML="âœ… Ù¾Ø§Ø³ÙˆØ±Úˆ ØªØ¨Ø¯ÛŒÙ„ ÛÙˆ Ú¯ÛŒØ§";
 document.getElementById("newPass").value="";
}

function addBookField(){
 const grid = document.getElementById("booksGrid");
 const div = document.createElement("div");
 div.innerHTML=`<input placeholder="Ú©ØªØ§Ø¨ Ú©Ø§ Ù†Ø§Ù…" class="bookName"><input placeholder="Max Ù†Ù…Ø¨Ø±" class="bookMarks">`;
 grid.appendChild(div);
}

function loadClassBooks(){
 const selectedClass = document.getElementById("className").value;
 const grid = document.getElementById("booksGrid");
 grid.innerHTML="";
 if(classBooks[selectedClass]){
   classBooks[selectedClass].forEach(book=>{
     const div = document.createElement("div");
     div.innerHTML=`<input value="${book.name}" class="bookName" readonly><input value="${book.max}" class="bookMarks">`;
     grid.appendChild(div);
   });
 }
}

function saveClassBooks(){
 const selectedClass = document.getElementById("className").value;
 const names=document.querySelectorAll(".bookName");
 const marks=document.querySelectorAll(".bookMarks");
 const books=[];
 names.forEach((n,i)=>{
   if(n.value.trim()!==""){
     books.push({name:n.value,max: +marks[i].value});
   }
 });
 classBooks[selectedClass]=books;
 localStorage.setItem("classBooks",JSON.stringify(classBooks));
}

function addStudent(){
 saveClassBooks();
 const selectedClass = document.getElementById("className").value;
 const books = classBooks[selectedClass] || [];
 const marks = [];
 books.forEach((b,i)=>{
   const markInput = document.querySelectorAll(".bookMarks")[i];
   marks.push(+markInput.value);
 });
 students[roll.value]={
  name:studentName.value,
  father:fatherName.value,
  class:selectedClass,
  year:document.getElementById("year") ? document.getElementById("year").value : "2025",
  gender:document.getElementById("gender") ? document.getElementById("gender").value : "Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù…",
  books: books,
  marks: marks,
  examType: document.getElementById("examType").value
 };
 localStorage.setItem("students",JSON.stringify(students));
 msg.innerHTML="âœ… Ù…Ø­ÙÙˆØ¸ ÛÙˆ Ú¯ÛŒØ§";
}

function deleteStudent(){
 if(!roll.value || !students[roll.value]) { msg.innerHTML="âŒ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº"; return; }
 delete students[roll.value];
 localStorage.setItem("students",JSON.stringify(students));
 msg.innerHTML="âœ… Ù†ØªÛŒØ¬Û Ø­Ø°Ù ÛÙˆ Ú¯ÛŒØ§";
}

function checkStudentResult(){
 let stuRoll=document.getElementById("stuRoll").value;
 let stuYear=document.getElementById("stuYear").value;
 let stuGender=document.getElementById("stuGender").value;
 let stuClass=document.getElementById("stuClass").value;
 let s = students[stuRoll];

 if(!s || s.year !== stuYear || s.gender !== stuGender || s.class !== stuClass){
   document.getElementById("stuResult").innerHTML="<p class='fail'>âŒ Ù†ØªÛŒØ¬Û Ù†ÛÛŒÚº Ù…Ù„Ø§</p>";
   return;
 }

 let total = s.marks.reduce((a,b)=>a+b,0);
 let maxTotal = s.books.reduce((a,b)=>a+b.max,0);
 let per = ((total/maxTotal)*100).toFixed(2);
 let grade = per>=80?"Ù…Ù…ØªØ§Ø²":per>=70?"Ø¬ÛŒØ¯":per>=50?"Ù…Ù‚Ø¨ÙˆÙ„":"Ø±Ø³ÛŒØ¯";
 let status = per>=50?"âœ… Ú©Ø§Ù…ÛŒØ§Ø¨":"âŒ Ù†Ø§Ú©Ø§Ù…";
 let rows = "";
 s.books.forEach((book,i)=>{
   rows+=`<tr><td>${book.name}</td><td>${s.marks[i]} / ${book.max}</td></tr>`;
 });

 document.getElementById("stuResult").innerHTML=`
 <b>Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù…:</b> ${s.name}<br>
 <b>ÙˆØ§Ù„Ø¯ Ú©Ø§ Ù†Ø§Ù…:</b> ${s.father}<br>
 <b>Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±:</b> ${stuRoll}<br>
 <b>Ú©Ù„Ø§Ø³:</b> ${s.class}<br>
 <b>Ø³Ø§Ù„:</b> ${s.year}<br>
 <b>Ø§Ù…ØªØ­Ø§Ù† Ú©ÛŒ Ù‚Ø³Ù…:</b> ${s.examType}<br>
 <table><tr><th>Ú©ØªØ§Ø¨ / Ù…Ø¶Ù…ÙˆÙ†</th><th>Ø­Ø§ØµÙ„ Ú©Ø±Ø¯Û Ù†Ù…Ø¨Ø±</th></tr>${rows}</table>
 <b>Ú©Ù„ Ù†Ù…Ø¨Ø±:</b> ${total} / ${maxTotal}<br>
 <b>ÙÛŒØµØ¯:</b> ${per}%<br>
 <b>Ú¯Ø±ÛŒÚˆ:</b> ${grade}<br>
 <b>Ù†ØªÛŒØ¬Û:</b> ${status}
 `;
}

function backSearch(){
 document.getElementById("stuResult").innerHTML="";
 document.getElementById("stuRoll").value="";
}

function printStudentResult(){
 let c=document.getElementById("stuResult").innerHTML;
 document.body.innerHTML="<h2 style='text-align:center'>Anwar-ul-Uloom Islamic University - Ù†ØªÛŒØ¬Û</h2><hr>"+c;
 window.print();
 location.reload();
}

function downloadBackup(){
 saveClassBooks();
 let data=JSON.stringify({students,classBooks});
 let a=document.createElement("a");
 a.href=URL.createObjectURL(new Blob([data]));
 a.download="islamic_university_results.json";
 a.click();
}

function uploadBackup(input){
 let file=input.files[0];
 let reader=new FileReader();
 reader.onload=()=>{ 
   const data=JSON.parse(reader.result);
   students=data.students||{};
   classBooks=data.classBooks||{};
   localStorage.setItem("students",JSON.stringify(students));
   localStorage.setItem("classBooks",JSON.stringify(classBooks));
   alert("âœ… Restore Complete"); 
};
 reader.readAsText(file);
}
</script>
</body>
</html>
